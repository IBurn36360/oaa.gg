!function(){var e=window.__GRN;window[e].ready(function(){window[e].SteamAuth=function(){var n=0,t=null,o=[],i=!1,a=function(n){t=JSON.parse(n);var i=document.getElementById("steamProfile");if(i.innerHTML="",t&&t.statusCode&&404===t.statusCode)i.innerHTML="Go play Open Angel Arena to become ranked!";else if(t&&t.steamid&&t.profile){var a=document.createElement("div"),d=document.createElement("div"),r=document.createElement("div"),u=document.createElement("div"),c=document.createElement("span"),w=document.createElement("span");if(a.innerHTML=t.profile.name.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;"),c.innerHTML=t.unrankedMMR,w.innerHTML=t.rankedMMR,d.appendChild(c),w.appendChild(w),u.appendChild(d),u.appendChild(r),i.appendChild(w),i.appendChild(a),i.appendChild(u),t.profile.avatar){var l=document.createElement("img");l.setAttrinute("src",t.profile.avatar),i.appendChild(l)}}window[e].awaitModulePrepared("Debug",function(){window[e].Debug.writeConsoleMessage("Running onAuthenticated callbacks","SteamAuth",window[e].Debug.LOG_LEVEL_INFO)});for(var s=0,p=o.length;s<p;s++)window[e].handleRunCallback(o[s])},d=function(n){window[e].awaitModulePrepared("Debug",function(n){window[e].Debug.writeConsoleMessage("User profile data was unable to be fetched!","SteamAuth",window[e].Debug.LOG_LEVEL_ERROR),window[e].Debug.writeConsoleObject(n,"SteamAuth",window[e].Debug.LOG_LEVEL_ERROR)}.bind(this,n))},r=function(){window[e].awaitModulePrepared("Debug",function(){window[e].Debug.writeConsoleMessage("User is not currently authenticated","SteamAuth",window[e].Debug.LOG_LEVEL_INFO)}),document.querySelector("body>nav .steamAuth").classList.remove("loading"),window[e].awaitModulePrepared("Debug",function(){window[e].Debug.writeConsoleMessage("Bound interactions for nav button for authentication","SteamAuth",window[e].Debug.LOG_LEVEL_INFO)})},u=function(){window.localStorage.setItem("OAAGGS64",Date.now()+6048e5+":"+n),function(){n||r(),window[e].awaitModulePrepared("Debug",function(){window[e].Debug.writeConsoleMessage("User is currently authenticated","SteamAuth",window[e].Debug.LOG_LEVEL_INFO)}),i=!0;var t=window.localStorage.getItem("OAAGGSUP");if(t){var o=t.split(":");if(Number(o.splice(0,1))>Date.now())return void a(o.join(":"))}window.fetch("https://chrisinajar.com:4969/users/"+window[e].SteamAuth.currentUserSteam32,{cache:"default"}).then(function(e){e.text().then(function(e){window.localStorage.setItem("OAAGGSUP",Date.now()+3e5+":"+e),a(e)}).catch(d)}).catch(d)}()};return{__init:function(){window[e].awaitModulePrepared("URL",function(){document.getElementById("steamAuth").setAttribute("href","https://steamcommunity.com/openid/login?openid.claimed_id="+encodeURIComponent("http://specs.openid.net/auth/2.0/identifier_select")+"&openid.identity="+encodeURIComponent("http://specs.openid.net/auth/2.0/identifier_select")+"&openid.mode="+encodeURIComponent("checkid_setup")+"&openid.ns="+encodeURIComponent("http://specs.openid.net/auth/2.0")+"&openid.realm="+encodeURIComponent(window.location.origin)+"&openid.return_to="+encodeURIComponent(window.location.origin+window.location.pathname));try{var t=window.localStorage.getItem("OAAGGS64");if(t&&-1!==t.indexOf(":")){var o=t.split(":");Number(o[0])>Date.now()?(n=o[1],u()):r()}else{var i=window[e].URL.searchParamValue("openid.identity");i&&(i=i.replace(/^https:\/\/steamcommunity.com\/openid\/id\//,""))?(n=i,u()):r()}}catch(e){}})}.bind(this),registerOnAuthenticatedCallback:function(n){i?window[e].handleRunCallback(n):o.push(n)}.bind(this),get currentUserSteam32(){return(Number(n)-76561197960265730).toString()},get currentUserSteam64(){return n}}}(),window[e].modulePrepared("SteamAuth"),window[e].moduleReady(window[e].SteamAuth.__init)})}();
//# sourceMappingURL=SteamAuth.js.map
