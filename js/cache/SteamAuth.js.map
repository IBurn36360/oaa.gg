{"version":3,"sources":["SteamAuth.js"],"names":["rootObjectName","window","__GRN","ready","SteamAuth","onAuthenticatedCallbacks","userManagerInstance","handleUpdateNavToAuthenticated","handleUpdateNavToRequiresAuthentication","authButton","document","querySelector","classList","remove","addEventListener","signinPopup","__init","awaitModulePrepared","Oidc","UserManager","authority","client_id","redirect_uri","location","origin","pathname","scope","userStore","WebStorageStateStore","store","localStorage","checkSessionInterval","popupWindowTarget","open","automaticSilentRenew","getUser","then","catch","bind","this","registerOnAuthenticatedCallback","callback","push","currentUserSteam32","currentUserSteam64","modulePrepared","moduleReady"],"mappings":"CAAE,WACE,IAAIA,EAAiBC,OAAOC,MAE5BD,OAAOD,GAAgBG,MAAM,WACzBF,OAAOD,GAAgBI,UAAa,WAChC,IAAIC,KAEAC,EAA2B,KAE3BC,EAAiC,aAIjCC,EAA0C,WAC1C,IAAIC,EAAaC,SAASC,cAAc,uBAExCF,EAAWG,UAAUC,OAAO,WAE5BJ,EAAWK,iBAAiB,QAASR,EAAoBS,aACzDN,EAAWK,iBAAiB,MAASR,EAAoBS,aACzDN,EAAWK,iBAAiB,QAASR,EAAoBS,cAG7D,OACIC,OAAQ,WACJf,OAAOD,GAAgBiB,oBAAoB,SAAU,YAEjDX,EAAsB,IAAIY,KAAKC,aAC3BC,UAAW,qCACXC,UAAW,mCACXC,aAAcrB,OAAOsB,SAASC,OAASvB,OAAOsB,SAASE,SACvDC,MAAO,SACPC,UAAW,IAAIT,KAAKU,sBAChBC,MAAO5B,OAAO6B,eAElBC,qBAAsB,IACtBC,kBAAmB/B,OAAOgC,KAC1BC,sBAAsB,KAGNC,UACfC,KAAK7B,GACL8B,MAAM7B,MAEjB8B,KAAKC,MAEPC,gCAAiC,SAASC,GAIlCpC,EAAyBqC,KAAKD,IAEpCH,KAAKC,MAEPI,yBACI,OAAO,GAGXC,yBACI,OAAO,IAvDgB,GA4DnC3C,OAAOD,GAAgB6C,eAAe,aACtC5C,OAAOD,GAAgB8C,YAAY7C,OAAOD,GAAgBI,UAAUY,UAjE3E","file":"SteamAuth.js","sourcesContent":["!(function() {\n    var rootObjectName = window.__GRN;\n\n    window[rootObjectName].ready(function() {\n        window[rootObjectName].SteamAuth = (function () {\n            var onAuthenticatedCallbacks = [];\n            var hasBeenAuthenticated     = false;\n            var userManagerInstance      = null;\n\n            var handleUpdateNavToAuthenticated = function() {\n\n            };\n\n            var handleUpdateNavToRequiresAuthentication = function() {\n                var authButton = document.querySelector('body>nav .steamAuth');\n\n                authButton.classList.remove('loading');\n\n                authButton.addEventListener('click', userManagerInstance.signinPopup);\n                authButton.addEventListener('tap',   userManagerInstance.signinPopup);\n                authButton.addEventListener('touch', userManagerInstance.signinPopup);\n            };\n\n            return {\n                __init: function() {\n                    window[rootObjectName].awaitModulePrepared('OpenID', function() {\n                        // TODO: Do background Steam authentication first, then bind prompted authentication if that fails\n                        userManagerInstance = new Oidc.UserManager({\n                            authority: 'https://steamcommunity.com/openid/',\n                            client_id: '0FA551D64997BEF92A8FC8CBB1ECBA2B',\n                            redirect_uri: window.location.origin + window.location.pathname,\n                            scope: 'openid',\n                            userStore: new Oidc.WebStorageStateStore({\n                                store: window.localStorage\n                            }),\n                            checkSessionInterval: 30000,\n                            popupWindowTarget: window.open,\n                            automaticSilentRenew: true,\n                        });\n\n                        userManagerInstance.getUser()\n                            .then(handleUpdateNavToAuthenticated)\n                            .catch(handleUpdateNavToRequiresAuthentication);\n                    });\n                }.bind(this),\n\n                registerOnAuthenticatedCallback: function(callback) {\n                    if (hasBeenAuthenticated) {\n                        window[rootObjectName].handleRunCallback(callback);\n                    } else {\n                        onAuthenticatedCallbacks.push(callback);\n                    }\n                }.bind(this),\n\n                get currentUserSteam32() {\n                    return 0;\n                },\n\n                get currentUserSteam64() {\n                    return 0;\n                },\n            };\n        }());\n\n        window[rootObjectName].modulePrepared('SteamAuth');\n        window[rootObjectName].moduleReady(window[rootObjectName].SteamAuth.__init);\n    });\n}());\n"]}