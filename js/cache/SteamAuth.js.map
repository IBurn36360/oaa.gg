{"version":3,"sources":["SteamAuth.js"],"names":["rootObjectName","window","__GRN","ready","SteamAuth","onAuthenticatedCallbacks","hasBeenAuthenticated","userManagerInstance","handleUpdateNavToAuthenticated","user","handleUpdateNavToRequiresAuthentication","awaitModulePrepared","Debug","writeConsoleMessage","LOG_LEVEL_INFO","i","j","length","handleRunCallback","authButton","document","querySelector","removeEventListener","signinPopup","classList","remove","addEventListener","__init","Oidc","Log","logger","console","UserManager","authority","client_id","redirect_uri","location","origin","pathname","scope","userStore","WebStorageStateStore","store","localStorage","checkSessionInterval","popupWindowTarget","open","automaticSilentRenew","getUser","then","catch","bind","this","registerOnAuthenticatedCallback","callback","push","currentUserSteam32","currentUserSteam64","modulePrepared","moduleReady"],"mappings":"CAAE,WACE,IAAIA,EAAiBC,OAAOC,MAE5BD,OAAOD,GAAgBG,MAAM,WACzBF,OAAOD,GAAgBI,UAAa,WAChC,IAAIC,KACAC,GAA2B,EAC3BC,EAA2B,KAE3BC,EAAiC,SAASC,GACrCA,GACDC,IAGJT,OAAOD,GAAgBW,oBAAoB,QAAS,WAChDV,OAAOD,GAAgBY,MAAMC,oBAAoB,kCAAmC,YAAaZ,OAAOD,GAAgBY,MAAME,kBAGlIR,GAAuB,EAEvBL,OAAOD,GAAgBW,oBAAoB,QAAS,WAChDV,OAAOD,GAAgBY,MAAMC,oBAAoB,oCAAqC,YAAaZ,OAAOD,GAAgBY,MAAME,kBAMpI,IAHA,IAAIC,EAAI,EACJC,EAAIX,EAAyBY,OAEzBF,EAAIC,EAAGD,IACXd,OAAOD,GAAgBkB,kBAAkBb,EAAyBU,IAItE,IAAII,EAAaC,SAASC,cAAc,uBAExCF,EAAWG,oBAAoB,QAASf,EAAoBgB,aAC5DJ,EAAWG,oBAAoB,MAASf,EAAoBgB,aAC5DJ,EAAWG,oBAAoB,QAASf,EAAoBgB,cAG5Db,EAA0C,WAC1CT,OAAOD,GAAgBW,oBAAoB,QAAS,WAChDV,OAAOD,GAAgBY,MAAMC,oBAAoB,sCAAuC,YAAaZ,OAAOD,GAAgBY,MAAME,kBAGtI,IAAIK,EAAaC,SAASC,cAAc,uBAExCF,EAAWK,UAAUC,OAAO,WAE5BxB,OAAOD,GAAgBW,oBAAoB,QAAS,WAChDV,OAAOD,GAAgBY,MAAMC,oBAAoB,uDAAwD,YAAaZ,OAAOD,GAAgBY,MAAME,kBAGvJK,EAAWO,iBAAiB,QAASnB,EAAoBgB,aACzDJ,EAAWO,iBAAiB,MAASnB,EAAoBgB,aACzDJ,EAAWO,iBAAiB,QAASnB,EAAoBgB,cAG7D,OACII,OAAQ,WACJ1B,OAAOD,GAAgBW,oBAAoB,SAAU,WACjDV,OAAOD,GAAgBW,oBAAoB,QAAS,WAChDV,OAAOD,GAAgBY,MAAMC,oBAAoB,oCAAqC,YAAaZ,OAAOD,GAAgBY,MAAME,kBAGpIc,KAAKC,IAAIC,OAASC,SAElBxB,EAAsB,IAAIqB,KAAKI,aAC3BC,UAAW,qCACXC,UAAW,mCACXC,aAAclC,OAAOmC,SAASC,OAASpC,OAAOmC,SAASE,SACvDC,MAAO,SACPC,UAAW,IAAIZ,KAAKa,sBAChBC,MAAOzC,OAAO0C,eAElBC,qBAAsB,IACtBC,kBAAmB5C,OAAO6C,KAC1BC,sBAAsB,KAGNC,UACfC,KAAKzC,GACL0C,MAAMxC,MAEjByC,KAAKC,MAEPC,gCAAiC,SAASC,GAClChD,EACAL,OAAOD,GAAgBkB,kBAAkBoC,GAEzCjD,EAAyBkD,KAAKD,IAEpCH,KAAKC,MAEPI,yBACI,OAAO,GAGXC,yBACI,OAAO,IA9FgB,GAmGnCxD,OAAOD,GAAgB0D,eAAe,aACtCzD,OAAOD,GAAgB2D,YAAY1D,OAAOD,GAAgBI,UAAUuB,UAxG3E","file":"SteamAuth.js","sourcesContent":["!(function() {\n    var rootObjectName = window.__GRN;\n\n    window[rootObjectName].ready(function() {\n        window[rootObjectName].SteamAuth = (function () {\n            var onAuthenticatedCallbacks = [];\n            var hasBeenAuthenticated     = false;\n            var userManagerInstance      = null;\n\n            var handleUpdateNavToAuthenticated = function(user) {\n                if (!user) {\n                    handleUpdateNavToRequiresAuthentication();\n                }\n\n                window[rootObjectName].awaitModulePrepared('Debug', function() {\n                    window[rootObjectName].Debug.writeConsoleMessage('User is currently authenticated', 'SteamAuth', window[rootObjectName].Debug.LOG_LEVEL_INFO);\n                });\n\n                hasBeenAuthenticated = true;\n\n                window[rootObjectName].awaitModulePrepared('Debug', function() {\n                    window[rootObjectName].Debug.writeConsoleMessage('Running onAuthenticated callbacks', 'SteamAuth', window[rootObjectName].Debug.LOG_LEVEL_INFO);\n                });\n\n                var i = 0;\n                var j = onAuthenticatedCallbacks.length;\n\n                for (i; i < j; i++) {\n                    window[rootObjectName].handleRunCallback(onAuthenticatedCallbacks[i]);\n                }\n\n                // Remove the handlers for authenticating\n                var authButton = document.querySelector('body>nav .steamAuth');\n\n                authButton.removeEventListener('click', userManagerInstance.signinPopup);\n                authButton.removeEventListener('tap',   userManagerInstance.signinPopup);\n                authButton.removeEventListener('touch', userManagerInstance.signinPopup);\n            };\n\n            var handleUpdateNavToRequiresAuthentication = function() {\n                window[rootObjectName].awaitModulePrepared('Debug', function() {\n                    window[rootObjectName].Debug.writeConsoleMessage('User is not currently authenticated', 'SteamAuth', window[rootObjectName].Debug.LOG_LEVEL_INFO);\n                });\n\n                var authButton = document.querySelector('body>nav .steamAuth');\n\n                authButton.classList.remove('loading');\n\n                window[rootObjectName].awaitModulePrepared('Debug', function() {\n                    window[rootObjectName].Debug.writeConsoleMessage('Bound interactions for nav button for authentication', 'SteamAuth', window[rootObjectName].Debug.LOG_LEVEL_INFO);\n                });\n\n                authButton.addEventListener('click', userManagerInstance.signinPopup);\n                authButton.addEventListener('tap',   userManagerInstance.signinPopup);\n                authButton.addEventListener('touch', userManagerInstance.signinPopup);\n            };\n\n            return {\n                __init: function() {\n                    window[rootObjectName].awaitModulePrepared('OpenID', function() {\n                        window[rootObjectName].awaitModulePrepared('Debug', function() {\n                            window[rootObjectName].Debug.writeConsoleMessage('Initializing Steam authentication', 'SteamAuth', window[rootObjectName].Debug.LOG_LEVEL_INFO);\n                        });\n\n                        Oidc.Log.logger = console;\n\n                        userManagerInstance = new Oidc.UserManager({\n                            authority: 'https://steamcommunity.com/openid/',\n                            client_id: '0FA551D64997BEF92A8FC8CBB1ECBA2B',\n                            redirect_uri: window.location.origin + window.location.pathname,\n                            scope: 'openid',\n                            userStore: new Oidc.WebStorageStateStore({\n                                store: window.localStorage\n                            }),\n                            checkSessionInterval: 30000,\n                            popupWindowTarget: window.open,\n                            automaticSilentRenew: true,\n                        });\n\n                        userManagerInstance.getUser()\n                            .then(handleUpdateNavToAuthenticated)\n                            .catch(handleUpdateNavToRequiresAuthentication);\n                    });\n                }.bind(this),\n\n                registerOnAuthenticatedCallback: function(callback) {\n                    if (hasBeenAuthenticated) {\n                        window[rootObjectName].handleRunCallback(callback);\n                    } else {\n                        onAuthenticatedCallbacks.push(callback);\n                    }\n                }.bind(this),\n\n                get currentUserSteam32() {\n                    return 0;\n                },\n\n                get currentUserSteam64() {\n                    return 0;\n                },\n            };\n        }());\n\n        window[rootObjectName].modulePrepared('SteamAuth');\n        window[rootObjectName].moduleReady(window[rootObjectName].SteamAuth.__init);\n    });\n}());\n"]}